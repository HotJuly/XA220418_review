#  跨域相关

1. 问题一:什么是跨域

   1. 违反了浏览器的同源策略

   2. 问题:什么是同源策略?

      1. 一个URL的组成部分:协议名+域名/主机地址+端口号+查询字符串

      2. 查询字符串其实就是路由接口+请求参数

      3. 同源就是两个URL的协议名+域名+端口都相同

      4. ```javascript
         //例子一:协议名不同,所以不同源
         	http://localhost:3000/about
         	ftp://localhost:3000/about

         //例子二:虽然最终找到的ip相同,但是域名不同,所以不同源
         	http://localhost:3000/about
         	http://127.0.0.1:3000/about

         //例子三:虽然接口不同,但是查询字符串不在同源的判断范围之内,所以同源
         	http://localhost:3000/about?a=b
         	http://localhost:3000/home?a=b1
         ```

         ​

      5. ​

2. 问题二:跨域一定会报错吗?

   1. 不一定
   2. 服务器之间跨域不报错
   3. img/audio/video/script/link等标签请求跨域资源,但是不报错
   4. 小总结:**跨域是一个行为,这个行为不一定会报错**

3. 问题三:什么情况下会出现跨域问题

   1. 在浏览器中,发送ajax请求才会穿跨域问题
   2. 小总结:**跨域报错是浏览器搞的鬼**

4. 问题四:哪些请求算是ajax请求(ajax->async javascript and xml)

   1. 使用标签页输入地址回车,只是HTTP请求,不是ajax请求
   2. 使用img标签展示图片,只是HTTP请求,不是ajax请求
   3. 简单说法:发送一个ajax请求
   4. 完整说法:使用ajax技术发送一个http请求
   5. 小总结:**ajax只是一种发送HTTP请求的技术,他不是一种特殊的请求**

5. 跨域问题解决方案

   1. JSONP
      1. 原理:利用了script标签发送请求不会报跨域错误的特点
      2. 流程:
         1. 前端网页在全局准备好存储数据的data变量和用于接收数据的getData函数
         2. 当用户触发某个操作时候,我们将会创建script标签,并给该标签添加src属性,属性值就是服务器的jsonp接口
         3. 前端网页通过接口,将getData函数的名称传递给后端服务器
         4. 后端服务器根据得到的函数名称字符串,以及需要返回的数据,组合成为一段全新的文本内容
         5. 最终服务器返回文本内容,前端网页的script标签会将返回的文本内容作为js代码编译,并自动执行
   2. CORS(跨域资源共享)
      1. 原理:其实请求可以发送到服务器,只是返回响应的时候,浏览器故意报错,不接收数据
      2. 流程:
         1. 服务器在返回响应的时候,给自己的响应头中添加配置即可
            1. Access-Control-Allow-Origin: http://www.baidu.com
   3. proxy
      1. 原理:利用服务器之间跨域不报错的效果实现的
      2. 流程:
         1. 在项目的脚手架中,配置proxy代理规则,记得重启项目
         2. 在需要转发的请求前面,添加转发请求的前缀(例如:/api)
         3. 当前网页请求自家的devServer服务器,属于同源请求,不会报错
         4. devServer根据流程配置的代理规则,自动请求对应的数据服务器
         5. 数据服务器返回相关响应数据给devServer,devServer也顺势返回响应给我们的前端网页
      3. 注意:该方案只有项目开发的时候才能使用,上线之后就失效了

